  METHOD IF_HTTP_EXTENSION~HANDLE_REQUEST.
  DATA : lv_json TYPE string.
    SELECT *
           FROM /DMO/FLIGHT
           WHERE carrier_id = @( to_upper(
             cl_abap_dyn_prg=>escape_quotes(
               val = escape( val = server->request->get_form_field(
                                                      name = `carrier_id` )
                             format = cl_abap_format=>e_xss_ml ) ) ) )
           INTO TABLE @DATA(connections) ##no_text.

    "cl_demo_output=>get converts ABAP data to HTML and is secure
    "server->response->set_cdata(
     " data = cl_demo_output=>get( connections ) ).

   /ui2/cl_json=>serialize(
     EXPORTING
       data     = connections      " Data to serialize
     RECEIVING
       r_json   = lv_json ).

    server->response->set_cdata(
      data = cl_demo_output=>get( lv_json ) ).


  ENDMETHOD.
